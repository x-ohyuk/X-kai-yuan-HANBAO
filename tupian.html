<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>å‘é€å›¾ç‰‡</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Display', 'Segoe UI', Roboto, Arial,
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #a1c4fd 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        animation: backgroundShift 10s ease-in-out infinite;
      }

      @keyframes backgroundShift {
        0%,
        100% {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #a1c4fd 100%);
        }
        33% {
          background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 50%, #667eea 100%);
        }
        66% {
          background: linear-gradient(135deg, #764ba2 0%, #667eea 50%, #c2e9fb 100%);
        }
      }

      .iphone-frame {
        width: 390px;
        height: 844px;
        border-radius: 54px;
        background: linear-gradient(180deg, #0f1724 0%, #0b1220 60%);
        border: none;
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.02), inset 0 -6px 20px rgba(0, 0, 0, 0.6),
          0 8px 30px rgba(2, 6, 23, 0.55);
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .screen {
        width: 370px;
        height: 804px;
        border-radius: 44px;
        background: #f7f7f7;
        position: relative;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      /* çµåŠ¨å²› */
      .dynamic-island {
        position: absolute;
        top: 18px;
        left: 50%;
        transform: translateX(-50%);
        width: 120px;
        height: 36px;
        background: #0b0b0b;
        border-radius: 18px;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
        z-index: 10;
      }

      /* çŠ¶æ€æ  */
      .status-bar {
        position: absolute;
        top: 6px;
        left: 0;
        width: 100%;
        height: 48px;
        display: flex;
        align-items: flex-end;
        justify-content: space-between;
        padding: 6px 18px;
        color: #000;
        font-size: 15px;
        font-weight: 600;
        pointer-events: none;
        z-index: 5;
      }

      .status-left {
        font-weight: 600;
      }
      .status-right {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      /* å¯¼èˆªæ  */
      .navbar {
        height: 60px;
        background: #f7f7f7;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 16px;
        border-bottom: 1px solid #e8e8e8;
        margin-top: 54px;
      }

      .nav-left {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .back-btn {
        width: 32px;
        height: 32px;
        border: none;
        background: #007aff;
        color: #fff;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .back-btn:hover {
        background: #0056cc;
        transform: scale(1.05);
      }

      .nav-title {
        font-size: 18px;
        font-weight: 600;
        color: #1a1a1a;
      }

      /* ä¸»å†…å®¹åŒºåŸŸ */
      .main-content {
        flex: 1;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 20px;
        overflow-y: auto;
      }

      /* å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ */
      .upload-area {
        border: 2px dashed #007aff;
        border-radius: 12px;
        padding: 40px 20px;
        text-align: center;
        background: rgba(0, 122, 255, 0.05);
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        min-height: 200px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      .upload-area:hover {
        background: rgba(0, 122, 255, 0.1);
        border-color: #0056cc;
      }

      .upload-icon {
        font-size: 48px;
        margin-bottom: 16px;
        opacity: 0.6;
      }

      .upload-text {
        font-size: 16px;
        color: #333;
        margin-bottom: 8px;
        font-weight: 500;
      }

      .upload-subtext {
        font-size: 14px;
        color: #666;
        line-height: 1.4;
      }

      .file-input {
        display: none;
      }

      /* å›¾ç‰‡é¢„è§ˆåŒºåŸŸ */
      .preview-area {
        display: none;
        flex-direction: column;
        gap: 16px;
      }

      .preview-container {
        position: relative;
        border-radius: 12px;
        overflow: hidden;
        background: #fff;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
        cursor: pointer;
      }

      .preview-image {
        width: 100%;
        max-height: 300px;
        object-fit: contain;
        display: block;
      }

      .preview-info {
        padding: 12px 16px;
        background: #f8f9fa;
        font-size: 14px;
        color: #666;
      }

      /* å“åº”å¼è®¾è®¡ */
      @media (max-width: 400px) {
        .iphone-frame {
          width: 100vw;
          height: 100vh;
          border-radius: 0;
        }

        .screen {
          width: 100%;
          height: 100%;
          border-radius: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="iphone-frame">
      <div class="screen">
        <!-- çµåŠ¨å²› -->
        <div class="dynamic-island"></div>

        <!-- çŠ¶æ€æ  -->
        <div class="status-bar">
          <div class="status-left" id="currentTime">9:41</div>
          <div class="status-right">
            <span>100%</span>
            <span>ğŸ”‹</span>
          </div>
        </div>

        <!-- å¯¼èˆªæ  -->
        <div class="navbar">
          <div class="nav-left">
            <button class="back-btn" onclick="goBack()">â€¹</button>
            <div class="nav-title">ğŸ“· å‘é€å›¾ç‰‡</div>
          </div>
        </div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
          <!-- ä¸Šä¼ åŒºåŸŸ -->
          <div class="upload-area" id="uploadArea" onclick="selectFile()">
            <div class="upload-icon">ğŸ“·</div>
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡</div>
            <div class="upload-subtext">
              æ”¯æŒ JPGã€PNGã€GIF æ ¼å¼<br />
              ç‚¹å‡»å›¾ç‰‡å³å¯å‘é€
            </div>
            <input type="file" class="file-input" id="fileInput" accept="image/*" onchange="handleFileSelect(event)" />
          </div>

          <!-- é¢„è§ˆåŒºåŸŸ -->
          <div class="preview-area" id="previewArea">
            <div class="preview-container" id="previewContainer" onclick="sendImage()">
              <img class="preview-image" id="previewImage" alt="å›¾ç‰‡é¢„è§ˆ" />
              <div class="preview-info" id="previewInfo">ç‚¹å‡»å›¾ç‰‡å‘é€</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let selectedFile = null;

      // é¡µé¢åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function () {
        updateTime();
        setInterval(updateTime, 60000);
      });

      // æ›´æ–°çŠ¶æ€æ æ—¶é—´
      function updateTime() {
        const now = new Date();
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');
        const timeString = `${hours}:${minutes}`;

        const timeElement = document.getElementById('currentTime');
        if (timeElement) {
          timeElement.textContent = timeString;
        }
      }

      // é€‰æ‹©æ–‡ä»¶
      function selectFile() {
        document.getElementById('fileInput').click();
      }

      // å¤„ç†æ–‡ä»¶é€‰æ‹©
      function handleFileSelect(event) {
        const file = event.target.files[0];
        if (file) {
          handleFile(file);
        }
      }

      // å¤„ç†æ–‡ä»¶
      function handleFile(file) {
        // éªŒè¯æ–‡ä»¶ç±»å‹
        if (!file.type.startsWith('image/')) {
          alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼');
          return;
        }

        // éªŒè¯æ–‡ä»¶å¤§å° (10MB)
        const maxSize = 10 * 1024 * 1024;
        if (file.size > maxSize) {
          alert('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 10MBï¼');
          return;
        }

        selectedFile = file;
        showPreview(file);
      }

      // æ˜¾ç¤ºé¢„è§ˆ
      function showPreview(file) {
        const reader = new FileReader();

        reader.onload = function (e) {
          const previewImage = document.getElementById('previewImage');
          const previewInfo = document.getElementById('previewInfo');
          const uploadArea = document.getElementById('uploadArea');
          const previewArea = document.getElementById('previewArea');

          previewImage.src = e.target.result;

          // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
          const sizeInMB = (file.size / (1024 * 1024)).toFixed(2);
          const dimensions = `${file.name} â€¢ ${sizeInMB}MB â€¢ ç‚¹å‡»å‘é€`;
          previewInfo.textContent = dimensions;

          // åˆ‡æ¢æ˜¾ç¤º
          uploadArea.style.display = 'none';
          previewArea.style.display = 'flex';
        };

        reader.readAsDataURL(file);
      }

      // å‘é€å›¾ç‰‡ - å®Œå…¨ç…§æ¬è¡¨æƒ…åŒ…çš„é€»è¾‘
      function sendImage() {
        if (!selectedFile) {
          alert('è¯·å…ˆé€‰æ‹©å›¾ç‰‡ï¼');
          return;
        }

        // å°†å›¾ç‰‡è½¬æ¢ä¸ºbase64å¹¶ä¿å­˜åˆ°localStorage
        const reader = new FileReader();

        reader.onload = function (e) {
          const imageData = {
            timestamp: Date.now(),
            fileName: selectedFile.name,
            fileSize: selectedFile.size,
            fileType: selectedFile.type,
            base64: e.target.result,
          };

          // ä¿å­˜åˆ°localStorageï¼Œå®Œå…¨åƒè¡¨æƒ…åŒ…ä¸€æ ·
          localStorage.setItem('selectedImage', JSON.stringify(imageData));

          // ç›´æ¥è¿”å›èŠå¤©ç•Œé¢ï¼Œå°±åƒè¡¨æƒ…åŒ…ä¸€æ ·
          goBack();
        };

        reader.readAsDataURL(selectedFile);
      }

      // è¿”å›ä¸Šä¸€é¡µ - å®Œå…¨ç…§æ¬è¡¨æƒ…åŒ…çš„é€»è¾‘
      function goBack() {
        const chatUrl = 'chat.html' + window.location.search;
        window.location.href = chatUrl;
      }
    </script>
  </body>
</html>
